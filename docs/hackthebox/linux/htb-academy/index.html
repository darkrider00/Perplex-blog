<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.127.0"><meta name=description content="Perplex007's Blog"><meta name=keywords content="hugo,site,new"><meta name=author content="Santhosh Vardan"><title>Academy |
Perplex007's blog
</title><link rel=stylesheet href=/css/index_d751713.min.96a155ca235ea4110f3c74ad120b5479b57965571983ab50f129f3cafde1647957ca404764cff59009ebf300839a60e97295038187b33a85a384bdb1537f9050.css integrity="sha512-lqFVyiNepBEPPHStEgtUebV5ZVcZg6tQ8Snzyv3hZHlXykBHZM/1kAnr8wCDmmDpcpUDgYezOoWjhL2xU3+QUA=="></head><body><header class=header><div class=header_left></div><div class=header_middle>Academy -
Perplex007's blog</div></header><main><aside class=sidebar><ul class=section-tree><li class="dir closed-dir"><span class=dir-text>Portswiggers</span><ul class=section-tree><li class=file><a href=https://example.org/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-bypass-xml-encoding/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-bypass-xml-encoding/>Sql Injection Vulnerbility With Filter Bypass via XML Encoding</a></li><li class=file><a href=https://example.org/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-where-clause/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-where-clause/>Sql Injection Vulnerbility in Where Clause Allowing Retrieval of Hidden Data</a></li><li class=file><a href=https://example.org/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-allowing-login-bypass/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-allowing-login-bypass/>Sql Injection Vulnerbility Allowing Login Bypass</a></li><li class=file><a href=https://example.org/portswigger/sql-injection/portswigger-sql-database-union-attack/ title=./portswigger/sql-injection/portswigger-sql-database-union-attack/>Sql Injection Union Attack Determining the Number of Columns Returned by the Query</a></li><li class=file><a href=https://example.org/portswigger/sql-injection/portswigger-sql-database-querying-oracle/ title=./portswigger/sql-injection/portswigger-sql-database-querying-oracle/>Sql Injection Querying Oracle</a></li><li class=file><a href=https://example.org/portswigger/sql-injection/portswigger-sql-database-querying-non-oracle/ title=./portswigger/sql-injection/portswigger-sql-database-querying-non-oracle/>Sql Injection Querying</a></li><li class=file><a href=https://example.org/portswigger/sql-injection/portswigger-sql-database-listing-oracle-databse/ title=./portswigger/sql-injection/portswigger-sql-database-listing-oracle-databse/>Sql Injection Listing Databse Contents</a></li><li class=file><a href=https://example.org/portswigger/sql-injection/portswigger-sql-database-listing/ title=./portswigger/sql-injection/portswigger-sql-database-listing/>Sql Injection</a></li><li class=file><a href=https://example.org/portswigger/server-side-vuln/portswigger-filepath-traversal/ title=./portswigger/server-side-vuln/portswigger-filepath-traversal/>File Path Traversal Simple Case</a></li></ul></li><li class="dir opened-dir"><span class=dir-text>HackTheBoxes</span><ul class=section-tree><li class=file><a href=https://example.org/hackthebox/windows/htb-crafty/ title=./hackthebox/windows/htb-crafty/>Crafty</a></li><li class=file><a href=https://example.org/hackthebox/starting-point/tier1/htb-sequel/ title=./hackthebox/starting-point/tier1/htb-sequel/>Sequel</a></li><li class=file><a href=https://example.org/hackthebox/starting-point/tier1/htb-responder/ title=./hackthebox/starting-point/tier1/htb-responder/>Responder</a></li><li class=file><a href=https://example.org/hackthebox/starting-point/tier1/htb-crocodile/ title=./hackthebox/starting-point/tier1/htb-crocodile/>Crocodile</a></li><li class=file><a href=https://example.org/hackthebox/starting-point/tier1/htb-appointment/ title=./hackthebox/starting-point/tier1/htb-appointment/>Appointment</a></li><li class=file><a href=https://example.org/hackthebox/starting-point/tier0/htb-meow/ title=./hackthebox/starting-point/tier0/htb-meow/>Meow</a></li><li class=file><a href=https://example.org/hackthebox/starting-point/tier0/htb-fawn/ title=./hackthebox/starting-point/tier0/htb-fawn/>Fawn</a></li><li class=file><a href=https://example.org/hackthebox/starting-point/tier0/htb-dancing/ title=./hackthebox/starting-point/tier0/htb-dancing/>Dancing</a></li><li class=file><a href=https://example.org/hackthebox/linux/htb-keeper/ title=./hackthebox/linux/htb-keeper/>Keeper</a></li><li class=file><a href=https://example.org/hackthebox/linux/htb-perfection/ title=./hackthebox/linux/htb-perfection/>Perfection</a></li><li class=file><a href=https://example.org/hackthebox/linux/htb-builder/ title=./hackthebox/linux/htb-builder/>Builder</a></li><li class=file><a href=https://example.org/hackthebox/linux/htb-academy/ title=./hackthebox/linux/htb-academy/>Academy</a></li></ul></li><li class="dir closed-dir"><span class=dir-text>Bandits</span><ul class=section-tree><li class=file><a href=https://example.org/bandit/bandit-level-5/ title=./bandit/bandit-level-5/>Level5</a></li><li class=file><a href=https://example.org/bandit/bandit-level-4/ title=./bandit/bandit-level-4/>Level4</a></li><li class=file><a href=https://example.org/bandit/bandit-level-3/ title=./bandit/bandit-level-3/>Level3</a></li><li class=file><a href=https://example.org/bandit/bandit-level-2/ title=./bandit/bandit-level-2/>Level2</a></li><li class=file><a href=https://example.org/bandit/bandit-level-1/ title=./bandit/bandit-level-1/>Level1</a></li><li class=file><a href=https://example.org/bandit/bandit-level-0/ title=./bandit/bandit-level-0/>Level0</a></li></ul></li><li class="dir closed-dir"><span class=dir-text>Posts</span><ul class=section-tree><li class=file><a href=https://example.org/posts/new-blog/ title=./posts/new-blog/>Hello</a></li></ul></li></ul></aside><aside class=exapandable></aside><article class=main><button class=sidebar-toggle-btn type=menu aria-expanded=false aria-haspopup=true>
<i class="bi bi-list"></i></button><div class=title><h1 class=title-header>Academy</h1><div class=author-date-readtime><div class=author title=Author><i class="bi bi-person"></i>
<a href=/author/santhosh-vardan/ class=cat-btn>Santhosh Vardan</a></div><div class=date title=Date><i class="bi bi-calendar3"></i>
<time datetime=2024.07.19>2024.07.19</time></div><div class=readtime title="Time to Read"><i class="bi bi-clock"></i>
2 mins to read</div></div></div><div class=article-meta><div class=categories><i class="bi bi-bookmarks" title=Categories></i>
<a href=/categories/hackthebox/ class=cat-btn>hackthebox
</a><a href=/categories/academy/ class=cat-btn>Academy
</a><a href=/categories/linux/ class=cat-btn>linux
</a><a href=/categories/easy/ class=cat-btn>Easy</a></div><div class=breadcumb><i class="bi bi-folder"></i>
<a href=https://example.org/ class=bread-btn><i class="bi bi-house-fill"></i>
Home
</a>/
<a href=https://example.org/hackthebox/ class=bread-btn>HackTheBoxes
</a>/
<a href=https://example.org/hackthebox/linux/htb-academy/ class=bread-btn>Academy</a></div></div><nav id=TableOfContents></nav><div class=content><p>Starting with Nmap
<img src="https://drive.google.com/file/d/1sCQX3MNkfCZ4rNc2L8K1VxFpynRx0sJu/view?usp=sharing" alt></p><p>we won&rsquo;t be able to connect to the website using only ip address so we can access the website after adiing the website in /etc/hosts</p><p><img src="https://drive.google.com/file/d/1GuLKw8od2OJGeH_XvUcYMVS744OBCR_6/view?usp=sharing" alt></p><p>The POST request to register a new user is interesting:</p><p><img src="https://drive.google.com/file/d/1QuY2o3TOeyhBcLKwFDl5PU5AhFOBcJ3F/view?usp=sharing" alt></p><p>While the <code>uid</code> (user id) and double password fields are expected, <code>roleid</code> is interesting. I’ll register again, but this time I’ll use Burp proxy to intercept the POST and change <code>roleid</code> to 1.</p><p><img src="https://drive.google.com/file/d/1qDiMrxbu4EQy_bmL7qvNkBK6w74SufjN/view?usp=sharing" alt></p><p>after changing the role everythign works same but this time it logged in to admin panel</p><p>here&rsquo;s the homepage of dev-staging-01
<img src="https://drive.google.com/file/d/1rj1LUuPLBGB-qHjWma7LobLj97oS_Miy/view?usp=sharing" alt></p><p><img src="https://drive.google.com/file/d/1gl3FOheWe20gozr2-xwAR7_r3ELGbLly/view?usp=sharing" alt></p><p>we found the app name and app key</p><p>google search about larvel exploit led e to this
<a href=https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/laravel>https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/laravel</a></p><p>there are exploits in github where we can clone them and exploit them on the ip directly</p><p>after a bit of research i&rsquo;ve found this
<a href=https://www.rapid7.com/db/modules/exploit/unix/http/laravel_token_unserialize_exec/>https://www.rapid7.com/db/modules/exploit/unix/http/laravel_token_unserialize_exec/</a></p><p>i fired up msfconsole ot use the exploit
<img src="https://drive.google.com/file/d/1wSpn7n08tOPyfHdYNrE-CDl9SWS_gRtn/view?usp=sharing" alt></p><p>after setting Rhost Lhost options and running we got a terminal
<img src="https://drive.google.com/file/d/1hDOfMNxUdd2SsCP6fO8wv8aoSU31HAvz/view?usp=sharing" alt></p><p>we used python3 -c &lsquo;import pty;pty.spawn(&ldquo;bash&rdquo;)&rsquo; to beautify the terminal</p><p><img src="https://drive.google.com/file/d/1wEVe89Yv2mKiho5pr2AzPOf2nxix6uQm/view?usp=sharing" alt></p><p>from the above we can login with user cry0l1t3
<code>cr0l1t3</code> user was a member of the <code>adm</code> group. On a typical Linux system, this group is responsible for system administration and, notably, monitoring.
so loggedin with cry0l1t3 user and got the user flag
<img src="https://drive.google.com/file/d/1yewK6ByVWRfTcMTGx_eIFLf5Gv9_kbnY/view?usp=sharing" alt></p><p>using log inspection tool using the <code>aureport</code> tool I was able to find credentials for the <code>mrb3n</code> user</p><p><img src="https://drive.google.com/file/d/1sDLPaaNYdUmOb0NHMd7O7NZ3mRDTzA3Z/view?usp=sharing" alt></p><p>i logged in with mrb3n user and run the comamnds</p><p>TF=$(mktemp -d)
echo &lsquo;{&ldquo;scripts&rdquo;:{&ldquo;x&rdquo;:"/bin/sh -i 0&lt;&amp;3 1>&amp;3 2>&amp;3"}}&rsquo; >$TF/composer.json
sudo composer &ndash;working-dir=$TF run-script x</p><p>/bin/sh -i 0&lt;&amp;3 1>&amp;3 2>&amp;3</p><p>i got root access and got the rootflag</p><p><img src="https://drive.google.com/file/d/1SW2cRFumtev9anARZN5Nsx60DibBFSaw/view?usp=sharing" alt></p><p>i pwned the machine</p></div></article></main><footer class=footer><div class=footer-left><ul class=social><li>All Rights Reserved ®.</li><li>Santhosh Vardan</li><li><a href=mailto:santoshvardan007@gmail.com target=_blank><i class=bi-envelope></i></a></li><li><a href=https://github.com/darkrider00 target=_blank><i class=bi-github></i></a></li><li><a href=https://www.linkedin.com/in/perplex007/ target=_blank><i class=bi-linkedin></i></a></li><li><a href=https://t.me/the_last_uzumaki_0 target=_blank><i class=bi-telegram></i></a></li><li><a href=https://x.com/perplex_007 target=_blank><i class=bi-twitter></i></a></li></ul></div><div class=footer-right><ul class="control status clearfix"><li>Word Count:
267</li><li>en</li><li><a href=https://gohugo.io class=btn target=_blank>Hugo: 0.127.0</a></li><li><a href=https://github.com/JingWangTW/dark-theme-editor class=btn target=_blank>Theme: dark-theme-editor</a></li><li>Last modified: &nbsp;
<time>Jul 19 2024 14:09:37</time></li><li title></li></ul></div></footer></body><script type=text/javascript src=/js/index_d751713.min.5eeb120f16ea146352725c420364f87befead45f678142b8f0ffbef024646931fbc06bff07a7bd6cb57fa2f8cd8a21ba6a4ee5a278ec32303a378bc1cd17f246.js integrity="sha512-XusSDxbqFGNSclxCA2T4e+/q1F9ngUK48P++8CRkaTH7wGv/B6e9bLV/ovjNiiG6ak7lonjsMjA6N4vBzRfyRg=="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css></html>