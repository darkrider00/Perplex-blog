<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.127.0"><meta name=description content="Perplex007's Blog"><meta name=keywords content="hugo,site,new"><meta name=author content="Santhosh Vardan"><title>Sql Injection Vulnerbility With Filter Bypass via XML Encoding |
Perplex007's blog
</title><link rel=stylesheet href=/css/index_d751713.min.96a155ca235ea4110f3c74ad120b5479b57965571983ab50f129f3cafde1647957ca404764cff59009ebf300839a60e97295038187b33a85a384bdb1537f9050.css integrity="sha512-lqFVyiNepBEPPHStEgtUebV5ZVcZg6tQ8Snzyv3hZHlXykBHZM/1kAnr8wCDmmDpcpUDgYezOoWjhL2xU3+QUA=="></head><body><header class=header><div class=header_left></div><div class=header_middle>Sql Injection Vulnerbility With Filter Bypass via XML Encoding -
Perplex007's blog</div></header><main><aside class=sidebar><ul class=section-tree><li class="dir opened-dir"><span class=dir-text>Portswiggers</span><ul class=section-tree><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-bypass-xml-encoding/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-bypass-xml-encoding/>Sql Injection Vulnerbility With Filter Bypass via XML Encoding</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-where-clause/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-where-clause/>Sql Injection Vulnerbility in Where Clause Allowing Retrieval of Hidden Data</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-allowing-login-bypass/ title=./portswigger/sql-injection/portswigger-sql-injection-vulnerbility-allowing-login-bypass/>Sql Injection Vulnerbility Allowing Login Bypass</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-union-attack/ title=./portswigger/sql-injection/portswigger-sql-database-union-attack/>Sql Injection Union Attack Determining the Number of Columns Returned by the Query</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-querying-oracle/ title=./portswigger/sql-injection/portswigger-sql-database-querying-oracle/>Sql Injection Querying Oracle</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-querying-non-oracle/ title=./portswigger/sql-injection/portswigger-sql-database-querying-non-oracle/>Sql Injection Querying</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-listing-oracle-databse/ title=./portswigger/sql-injection/portswigger-sql-database-listing-oracle-databse/>Sql Injection Listing Databse Contents</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-database-listing/ title=./portswigger/sql-injection/portswigger-sql-database-listing/>Sql Injection</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/portswigger/server-side-vuln/portswigger-filepath-traversal/ title=./portswigger/server-side-vuln/portswigger-filepath-traversal/>File Path Traversal Simple Case</a></li></ul></li><li class="dir closed-dir"><span class=dir-text>HackTheBoxes</span><ul class=section-tree><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/windows/htb-crafty/ title=./hackthebox/windows/htb-crafty/>Crafty</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier1/htb-sequel/ title=./hackthebox/starting-point/tier1/htb-sequel/>Sequel</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier1/htb-responder/ title=./hackthebox/starting-point/tier1/htb-responder/>Responder</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier1/htb-crocodile/ title=./hackthebox/starting-point/tier1/htb-crocodile/>Crocodile</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier1/htb-appointment/ title=./hackthebox/starting-point/tier1/htb-appointment/>Appointment</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier0/htb-meow/ title=./hackthebox/starting-point/tier0/htb-meow/>Meow</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier0/htb-fawn/ title=./hackthebox/starting-point/tier0/htb-fawn/>Fawn</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/starting-point/tier0/htb-dancing/ title=./hackthebox/starting-point/tier0/htb-dancing/>Dancing</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-keeper/ title=./hackthebox/linux/htb-keeper/>Keeper</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-perfection/ title=./hackthebox/linux/htb-perfection/>Perfection</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-builder/ title=./hackthebox/linux/htb-builder/>Builder</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/hackthebox/linux/htb-academy/ title=./hackthebox/linux/htb-academy/>Academy</a></li></ul></li><li class="dir closed-dir"><span class=dir-text>Bandits</span><ul class=section-tree><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-5/ title=./bandit/bandit-level-5/>Level5</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-4/ title=./bandit/bandit-level-4/>Level4</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-3/ title=./bandit/bandit-level-3/>Level3</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-2/ title=./bandit/bandit-level-2/>Level2</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-1/ title=./bandit/bandit-level-1/>Level1</a></li><li class=file><a href=https://santhoshvardan-blog.vercel.app/bandit/bandit-level-0/ title=./bandit/bandit-level-0/>Level0</a></li></ul></li><li class="dir closed-dir"><span class=dir-text>Posts</span><ul class=section-tree><li class=file><a href=https://santhoshvardan-blog.vercel.app/posts/new-blog/ title=./posts/new-blog/>Hello</a></li></ul></li></ul></aside><aside class=exapandable></aside><article class=main><button class=sidebar-toggle-btn type=menu aria-expanded=false aria-haspopup=true>
<i class="bi bi-list"></i></button><div class=title><h1 class=title-header>Sql Injection Vulnerbility With Filter Bypass via XML Encoding</h1><div class=author-date-readtime><div class=author title=Author><i class="bi bi-person"></i>
<a href=/author/santhosh-vardan/ class=cat-btn>Santhosh Vardan</a></div><div class=date title=Date><i class="bi bi-calendar3"></i>
<time datetime=2024.07.20>2024.07.20</time></div><div class=readtime title="Time to Read"><i class="bi bi-clock"></i>
3 mins to read</div></div></div><div class=article-meta><div class=categories><i class="bi bi-bookmarks" title=Categories></i>
<a href=/categories/portswigger/ class=cat-btn>portswigger
</a><a href=/categories/sql-injection/ class=cat-btn>SQL injection
</a><a href=/categories/xml-encoding/ class=cat-btn>XML encoding</a></div><div class=breadcumb><i class="bi bi-folder"></i>
<a href=https://santhoshvardan-blog.vercel.app/ class=bread-btn><i class="bi bi-house-fill"></i>
Home
</a>/
<a href=https://santhoshvardan-blog.vercel.app/portswigger/ class=bread-btn>Portswiggers
</a>/
<a href=https://santhoshvardan-blog.vercel.app/portswigger/sql-injection/portswigger-sql-injection-vulnerbility-bypass-xml-encoding/ class=bread-btn>Sql Injection Vulnerbility With Filter Bypass via XML Encoding</a></div></div><nav id=TableOfContents><ul><li><a href=#hint>hint</a></li><li><a href=#alternative-encoding>Alternative encoding</a></li></ul></nav><div class=content><p><img src="https://drive.google.com/file/d/1270pepJqssVhmOKOZ8Jxjvqx2RxBb4MU/view?usp=sharing" alt></p><p>The above image is lab description
from the above description</p><ul><li>we know that there is a database that contains username and password</li><li>to solve the lab we have to retrieve the username and password and login to their account.</li></ul><p>Let&rsquo;s take a look at the hint</p><h2 id=hint>hint</h2><p><code>A web application firewall (WAF) will block requests that contain obvious signs of a SQL injection attack. You'll need to find a way to obfuscate your malicious query to bypass this filter. We recommend using the [Hackvertor](https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100) extension to do this.</code></p><p>the website :</p><p><img src="https://drive.google.com/file/d/1sV72o-t9d4DBYuCWxAfHECgUOb2XPfUZ/view?usp=sharing" alt></p><p>I&rsquo;ve turned on the burp proxy now let&rsquo;s navigate through the website.
let&rsquo;s check for inputs fields in the website for sql injection</p><p><img src="https://drive.google.com/file/d/1Dwih_iWh-pO1Vamkgv0rVrHpO3JjCRFp/view?usp=sharing" alt></p><p>here there is a input field if we click on view details of any product</p><p>now let&rsquo;s take a look at http history that is recorded in the burpsuite</p><p><img src="https://drive.google.com/file/d/1BXQ1cOHx5mBNpdDCENXSN0JgjfsB2i3b/view?usp=sharing" alt></p><p>here the server is requesting the product id and it is communicating with back so let&rsquo;s send this to repeater .</p><p><img src="https://drive.google.com/file/d/14dLiwrQghdHzbIB5wSAOdIa6wi6HGjTE/view?usp=sharing" alt></p><p><img src="https://drive.google.com/file/d/1qGzar8NT13Azx98U48hff25_swAO1JYv/view?usp=sharing" alt></p><p>here&rsquo;s when we click on check stock then we are getting the number units present at that location we can definitely inject some payloads here
let&rsquo;s send this to repeater too</p><p><img src="https://drive.google.com/file/d/1LLrYnkqSgoJAcIrv0CjNzpeHiVOIr_SR/view?usp=sharing" alt></p><p>in this when we input the product id we are getting number of units present
let&rsquo;s add <code>UNION SELECT NULL</code> to product id to determine number of columns.</p><p><img src="https://drive.google.com/file/d/1aRpq4kEkhM4M0PtBaepvyw7TqmAG76iO/view?usp=sharing" alt></p><p>we got attack detected that&rsquo;s why they gave us a hint about WAF in the hint section</p><ul><li>we need to obfusacate the input so that it will bypass the firewall , we need to install hackvetor extension to install hackvector extension go to extensions tab and go to bwapp store and search for hackvector extension as mentioned in [[SQL injection with filter bypass via XML encoding#hint]]
or you can encode manually refer to the last section</li></ul><p><img src="https://drive.google.com/file/d/1jK6Qn0tVoZ4eXVUXVvlMKM0NpIK_nFXo/view?usp=sharing" alt></p><ul><li>click on install to install the hack vector extension</li><li>for more information on the hack vector extension refer [[Hackvector extension]]</li></ul><p><img src="https://drive.google.com/file/d/1vXsB4UamHAZBVrBVbhX5vcazd3HRlzqk/view?usp=sharing" alt></p><p>as we can see hack vector extension has been installed and loaded we can see it in the repeater section</p><ul><li>to use the hackvector select the payload you&rsquo;ve already written and right click on it and select extensions and select encode using hex entities and then send the request.</li></ul><p><img src="https://drive.google.com/file/d/1X9hzTmHDj3-Ti-7czo75NvoHnuucHKLT/view?usp=sharing" alt></p><p>as you can see hex entities tags are added to the payload we&rsquo;ve selected</p><p><img src="https://drive.google.com/file/d/1_6z3y-D2ugrYeUot0LbgdHIIfo3pre9g/view?usp=sharing" alt></p><p>and Boom !</p><p><img src="https://drive.google.com/file/d/1p5PMa_C5LkQ15g7sNlBqcPA6YVu6igU4/view?usp=sharing" alt></p><p>we dind&rsquo;t get any attack detected in the response tab
we successfully bypassed the WAF with this extension</p><ul><li>now let&rsquo;s add another null to the statement to see if there are 2 columns</li><li>we can add ORDER by 2 or ORDER by 3 to determine the colums</li></ul><p><img src="https://drive.google.com/file/d/13LX4LNRMV79PSf8QTfBMJ7lUfHh_9pW0/view?usp=sharing" alt></p><p><img src="https://drive.google.com/file/d/15z71JLBPPtOngwMZt63p14bqZwakVI6w/view?usp=sharing" alt></p><p><img src="https://drive.google.com/file/d/1PQg_OWubXMgHSdcs4dMd28gimXwGtX8V/view?usp=sharing" alt>
we got 0 units that means only one column is present in the table</p><p>let&rsquo;s build a payload now to retrieve the username and password table</p><p><code>1 UNION SELECT username || '~' || password FROM users</code></p><ul><li>let&rsquo;s breakdown this payload we&rsquo;ve built union select is used to select and we are selecting username</li><li><strong><code>||</code></strong>: This is the string concatenation operator in SQL (specifically in databases like SQLite and PostgreSQL). It concatenates two or more strings.</li><li><strong><code>'~'</code></strong>: This is a tilde character being used as a delimiter (to separate username and password)</li><li>and passwords from table users</li></ul><p><img src="https://drive.google.com/file/d/1a8qgKWDu-GToWSaUHYiuWn3JII0eGryr/view?usp=sharing" alt></p><p>we got our username and passwords</p><p>in this lab we are looking for admin account so let&rsquo;s login with these details</p><p><img src="https://drive.google.com/file/d/1EFRIrhC4WoWRy0hOl7PtV7A7UgNwbHns/view?usp=sharing" alt></p><p>we are logged in and we solved the lab</p><p>for more detailed walkthrough : <a href=https://youtu.be/2iqMm0gMyHk>https://youtu.be/2iqMm0gMyHk</a></p><h2 id=alternative-encoding>Alternative encoding</h2><p>in this encoding we use online tools like cyberchef
maybe something like this
<img src="https://drive.google.com/file/d/1wmtVYkEVrkApxSxrN24zj5gTJ9wEJcUj/view?usp=sharing" alt></p></div></article></main><footer class=footer><div class=footer-left><ul class=social><li>All Rights Reserved ®.</li><li>Santhosh Vardan</li><li><a href=mailto:santoshvardan007@gmail.com target=_blank><i class=bi-envelope></i></a></li><li><a href=https://github.com/darkrider00 target=_blank><i class=bi-github></i></a></li><li><a href=https://www.linkedin.com/in/perplex007/ target=_blank><i class=bi-linkedin></i></a></li><li><a href=https://t.me/the_last_uzumaki_0 target=_blank><i class=bi-telegram></i></a></li><li><a href=https://x.com/perplex_007 target=_blank><i class=bi-twitter></i></a></li></ul></div><div class=footer-right><ul class="control status clearfix"><li>Word Count:
579</li><li>en</li><li><a href=https://gohugo.io class=btn target=_blank>Hugo: 0.127.0</a></li><li><a href=https://github.com/JingWangTW/dark-theme-editor class=btn target=_blank>Theme: dark-theme-editor</a></li><li>Last modified: &nbsp;
<time>Jul 20 2024 12:34:30</time></li><li title></li></ul></div></footer></body><script type=text/javascript src=/js/index_d751713.min.5eeb120f16ea146352725c420364f87befead45f678142b8f0ffbef024646931fbc06bff07a7bd6cb57fa2f8cd8a21ba6a4ee5a278ec32303a378bc1cd17f246.js integrity="sha512-XusSDxbqFGNSclxCA2T4e+/q1F9ngUK48P++8CRkaTH7wGv/B6e9bLV/ovjNiiG6ak7lonjsMjA6N4vBzRfyRg=="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css></html>